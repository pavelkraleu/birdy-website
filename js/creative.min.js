var dataset=null,svg=d3.select("#birdyRealTime"),svgElement=document.getElementById("birdyRealTime"),margin={top:20,right:20,bottom:20,left:20},width=svgElement.width.baseVal.value-margin.left-margin.right,height=svgElement.height.baseVal.value-margin.top-margin.bottom,g=svg.append("g").attr("transform","translate("+margin.left+","+margin.top+")"),timeParseMask=d3.timeParse("%Y-%m-%d %H:%M:%S"),parseValues=function(t){for(var e=0;e<t.length;++e)t[e].Date=timeParseMask(t[e].Date),t[e].Birds=+t[e].Birds,t[e]["Outdoor Temperature"]=+t[e]["Outdoor Temperature"];return t},x=d3.scaleTime().rangeRound([0,width]),y=d3.scaleLinear().rangeRound([height,0]),birdLine=d3.line().x(function(t){return x(t.Date)}).y(function(t){return y(t.Birds)}),temperatureLine=d3.line().x(function(t){return x(t.Date)}).y(function(t){return y(t["Outdoor Temperature"])});Tabletop.init({key:"https://docs.google.com/spreadsheets/d/1b-I_sqDUSi4DLrNH9eQgt1vGZ0ZJme892QrYkxmm1eg/pubhtml",callback:function(t,e){dataset=parseValues(t.Sheet1.elements),d3Magic()}});var d3Magic=function(){if(console.log(dataset),!dataset)return!1;var t=dataset;width=svgElement.width.baseVal.value-margin.left-margin.right,height=svgElement.height.baseVal.value-margin.top-margin.bottom,console.log(svg.select("g").select("g")),svg.select("path").remove(),x.domain(d3.extent(t,function(t){return t.Date})),y.domain(d3.extent(t,function(t){return t.Birds})),g.append("g").attr("transform","translate(0,"+height+")").call(d3.axisBottom(x)).select(".domain").remove(),g.append("g").call(d3.axisLeft(y)).append("text").attr("fill","#000").attr("transform","rotate(-90)").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("Birds (Blue) Temperature (Red)"),g.append("path").datum(t).attr("fill","none").attr("stroke","steelblue").attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke-width",2).attr("d",birdLine),g.append("path").datum(t).attr("fill","none").attr("stroke","red").attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke-width",2).attr("d",temperatureLine)};window.addEventListener("resize",d3Magic);